- 当前公司伪微服务存在的一些问题（个人拙见解决方案）
1. 不是真的微服务，不是按照业务划分，将多个大服务公用一个DAO服务，跟单体服务没有区别，并且没有引入分布式事物，导致数据的可靠性不高
   - 重新根据业务进行划分，引入分布式事物tx-lcn(后面准备接入阿里的分布式事物)
2. 代码大量重复，如远程调用代码
   - 将一个微服务划分为三个模块Client(远程调用与服务降级代码)，common(dto,vo,qo代码)，server(当前业务代码)，并且提供一个所有微服务中公用模块common
3. 服务中大量的join,sql很难优化，完全不考虑索引与后期分库分表
   - 禁止join，为了后面分库分表中无法处理跨库join的问题，所有的join在业务中通过代码来解决，并且在表设计之初根据业务加入适量的冗余，计划引入小米工具soar进行sql分析(也可以自己Explain，但是很多人不会)
4. 实体类随意自己需要什么字段就加什么字段
   - 按照阿里规范将实体分为entity，dto，vo，qo，并且详细讲解每个的作用（因为发现基本上都是只是知道这个东西，但是乱用）
5. mybatis.xml里面混乱不堪
   - 我们每个表对应两个包，一个是自己手写的(手写的里面只返回自己用到的字段，如果被删除，idea会检查到也方便检查)，一个是自动生成的单表的（可以随时重新生成），对应的同一Mapper，这样在数据库前期因为设计问题，需要大量的改字段的情况下能重新生成，尽可能的减少因为数据库字段增删导致的代码问题，也方便修改。
6. 喜欢自己造轮子
   - 例如Excel导出,实体类的验证等，完全可以使用成熟的工具包，使用自己的一不能保证稳定，并且写的不好会各种耦合性
7. 数据库使用中文，并且不允许注释，只能看文档
   - 数据库完全按照规范英文命名，并且每行添加注释，可以在使用自动生成工具时，把注释带上，提高开发的效率
8. 在使用实体类的时候很容易忘记写set，get，toString
   - 使用Lombok进行改造，让代码尽量整洁，方便随时修改
9. 查询的过程中有的分页有的不分页，分页参数被偶合在每个传输对象中
   - 利用Spring data中pageable,会把前端的传参分离为两个，避免偶合（Feign Client中高版本官网发布说支持，但是还没本地测试）
10. 当前公司的配置文件管理混乱
   - 引入apollo配置中心进行对于开发测试线上的配置文件的管理控制与实时推送刷新
11. 当前系统kafka，mysql采用最新版本
   - 应该考虑当前确定稳定版本例如kafka1.x.x，mysql 5.7.x,同时可以避免需要开源工具时因版本问题导致的不兼容
12. 將没有控制的异常信息直接只给了前端
    - 这样对于用户体验非常不好，使用SpringBoot的统一异常处理中心处理，返回友好提示

13. 微服务中我们为了开发效率的问题，在不同模块之间，可以根据模块的复杂程度，业务进行对于JAP还是mybatis的选择，能有效地发挥微服务的优势，提高开发效率

14. 在前后端分离的中,前端对数据的处理基本为0，后面增加了很多没有必要的查询与计算
    - 例如在我做的领带分析中，前端是知道点击节点下需要显示的节点数据的id，名称等，但是他们只传点击的id，我认为应该传递点击节点下的所有显示需要显示节点的id与层级数，后端要做的事情是去判断这些节点id在这个人对于这些节点id有没有权限，如果没有直接返回权限不够，如果有按照这些id查询出相应的数据（每次的请求都会去按照数据去数据库中很多表关联起来查询权限，效率特别低下）

15. 目前公司要求接口文档纯手写，这样效率低些，并且在实际中经常出现接口改变接口文档没有改变的情况，前端调试后台必须启动所有服务，机器卡顿（无mock）
    - 针对这个问题我们可以采用Swagger进行统一的接口文档管理，在接口改动的第一时间文档也改好了（缺点是对代码有侵入，没有mock功能）。还可以部署私有化的文档管理的如yapi，提供了文档的权限管理，api文档管理，自动化测试，mock等功能，大大的其提高了开发与测试对于文档的维护模拟测试的工作量（开发要保证接口改动的时更新文档）
   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    